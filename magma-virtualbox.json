{
    "variables": {
        "box_version": "{{env `VERSION`}}"
    },
    "provisioners": [
        {
            "type": "shell",
            "scripts": [
                "scripts/alpine36/network.sh",
                "scripts/alpine36/apk.sh"
            ],
            "execute_command": "/bin/sh '{{.Path}}'",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-alpine36-virtualbox"
            ]
        },
        {
            "type": "shell",
            "scripts": [
                "scripts/alpine36/limits.sh",
                "scripts/alpine36/mariadb.sh",
                "scripts/alpine36/memcached.sh",
                "scripts/alpine36/postfix.sh",
                "scripts/alpine36/hostname.sh",
                "scripts/alpine36/lsb.sh",
                "scripts/alpine36/floppy.sh",
                "scripts/alpine36/vagrant.sh",
                "scripts/alpine36/sshd.sh",
                "scripts/alpine36/glibc.sh",
                "scripts/alpine36/gcc.sh",
                "scripts/alpine36/magma.sh",
                "scripts/alpine36/virtualbox.sh",
                "scripts/alpine36/parallels.sh",
                "scripts/alpine36/vmware.sh",
                "scripts/alpine36/qemu.sh",
                "scripts/alpine36/cache.sh"
            ],
            "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-alpine36-virtualbox"
            ]
        },
        {
            "type": "shell",
            "scripts": [
                "scripts/centos6/base.sh",
                "scripts/centos6/network.sh"
            ],
            "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-centos6-virtualbox"
            ]
        },
        {
            "type": "shell",
            "scripts": [
                "scripts/centos6/kernel.sh",
                "scripts/centos6/vga.sh",
                "scripts/centos6/virtualbox.sh",
                "scripts/centos6/parallels.sh",
                "scripts/centos6/vmware.sh",
                "scripts/centos6/qemu.sh",
                "scripts/centos6/postfix.sh",
                "scripts/centos6/vagrant.sh",
                "scripts/centos6/magma.sh",
                "scripts/centos6/tuning.sh",
                "scripts/centos6/sshd.sh",
                "scripts/centos6/randomness.sh",
                "scripts/centos6/updatedb.sh",
                "scripts/centos6/cleanup.sh"
            ],
            "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-centos6-virtualbox"
            ]
        },
        {
            "type": "shell",
            "scripts": [
                "scripts/centos7/network.sh",
                "scripts/centos7/yum.sh",
                "scripts/centos7/base.sh",
                "scripts/centos7/reboot.sh"
            ],
            "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-centos7-virtualbox"
            ]
        },
        {
            "type": "shell",
            "scripts": [
                "scripts/centos7/kernel.sh",
                "scripts/centos7/floppy.sh",
                "scripts/centos7/virtualbox.sh",
                "scripts/centos7/parallels.sh",
                "scripts/centos7/vmware.sh",
                "scripts/centos7/qemu.sh",
                "scripts/centos7/postfix.sh",
                "scripts/centos7/vagrant.sh",
                "scripts/centos7/memcached.sh",
                "scripts/centos7/mariadb.sh",
                "scripts/centos7/magma.sh",
                "scripts/centos7/tuning.sh",
                "scripts/centos7/sshd.sh",
                "scripts/centos7/randomness.sh",
                "scripts/centos7/updatedb.sh",
                "scripts/centos7/cleanup.sh",
                "scripts/centos7/unyum.sh"
            ],
            "execute_command": "{{.Vars}} /bin/bash '{{.Path}}'",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-centos7-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/gentoo/network.sh",
                "scripts/gentoo/emerge.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-gentoo-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/gentoo/virtualbox.sh",
                "scripts/gentoo/parallels.sh",
                "scripts/gentoo/vmware.sh",
                "scripts/gentoo/qemu.sh",
                "scripts/gentoo/vagrant.sh",
                "scripts/gentoo/magma.sh"
            ],
            "type": "shell",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-gentoo-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/arch/pacman.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-arch-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/arch/limits.sh",
                "scripts/arch/mariadb.sh",
                "scripts/arch/memcached.sh",
                "scripts/arch/postfix.sh",
                "scripts/arch/virtualbox.sh",
                "scripts/arch/parallels.sh",
                "scripts/arch/vmware.sh",
                "scripts/arch/qemu.sh",
                "scripts/arch/vagrant.sh",
                "scripts/arch/magma.sh",
                "scripts/arch/cleanup.sh"
            ],
            "type": "shell",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-arch-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/debian8/apt.sh",
                "scripts/debian8/network.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-debian8-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/debian8/limits.sh",
                "scripts/debian8/postfix.sh",
                "scripts/debian8/mysql.sh",
                "scripts/debian8/memcached.sh",
                "scripts/debian8/floppy.sh",
                "scripts/debian8/profile.sh",
                "scripts/debian8/vagrant.sh",
                "scripts/debian8/motd.sh",
                "scripts/debian8/magma.sh",
                "scripts/debian8/fixtty.sh",
                "scripts/debian8/virtualbox.sh",
                "scripts/debian8/parallels.sh",
                "scripts/debian8/vmware.sh",
                "scripts/debian8/qemu.sh"
            ],
            "type": "shell",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-debian8-virtualbox"
            ]
        },
        {
            "type": "shell",
            "scripts": [
                "scripts/fedora27/fixdns.sh",
                "scripts/fedora27/dnf.sh"
            ],
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-fedora27-virtualbox"
            ]
        },
        {
            "type": "shell",
            "scripts": [
                "scripts/fedora27/base.sh"
            ],
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-fedora27-virtualbox"
            ]
        },
        {
            "type": "shell",
            "scripts": [
                "scripts/fedora27/kernel.sh",
                "scripts/fedora27/vga.sh",
                "scripts/fedora27/virtualbox.sh",
                "scripts/fedora27/parallels.sh",
                "scripts/fedora27/vmware.sh",
                "scripts/fedora27/qemu.sh",
                "scripts/fedora27/vagrant.sh",
                "scripts/fedora27/mariadb.sh",
                "scripts/fedora27/postfix.sh",
                "scripts/fedora27/magma.sh",
                "scripts/fedora27/tuning.sh"
            ],
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-fedora27-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/freebsd11/pkg.sh",
                "scripts/freebsd11/hostname.sh",
                "scripts/freebsd11/kernel.sh",
                "scripts/freebsd11/firstboot.sh",
                "scripts/freebsd11/motd.sh",
                "scripts/freebsd11/vagrant.sh",
                "scripts/freebsd11/magma.sh",
                "scripts/freebsd11/virtualbox.sh",
                "scripts/freebsd11/parallels.sh",
                "scripts/freebsd11/vmware.sh",
                "scripts/freebsd11/qemu.sh",
                "scripts/freebsd11/cleanup.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "execute_command": "/usr/local/bin/bash {{ .Path }}",
            "only": [
                "magma-freebsd11-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/openbsd6/pkg.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "execute_command": "/bin/sh {{ .Path }}",
            "only": [
                "magma-openbsd6-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/openbsd6/hostname.sh",
                "scripts/openbsd6/motd.sh",
                "scripts/openbsd6/vagrant.sh",
                "scripts/openbsd6/profile.sh",
                "scripts/openbsd6/virtualbox.sh",
                "scripts/openbsd6/parallels.sh",
                "scripts/openbsd6/vmware.sh",
                "scripts/openbsd6/qemu.sh",
                "scripts/openbsd6/magma.sh"
            ],
            "type": "shell",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "execute_command": "/usr/local/bin/bash {{ .Path }}",
            "only": [
                "magma-openbsd6-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/ubuntu1604/apt.sh",
                "scripts/ubuntu1604/network.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-ubuntu1604-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/ubuntu1604/limits.sh",
                "scripts/ubuntu1604/postfix.sh",
                "scripts/ubuntu1604/mysql.sh",
                "scripts/ubuntu1604/memcached.sh",
                "scripts/ubuntu1604/floppy.sh",
                "scripts/ubuntu1604/vagrant.sh",
                "scripts/ubuntu1604/motd.sh",
                "scripts/ubuntu1604/magma.sh",
                "scripts/ubuntu1604/fixtty.sh",
                "scripts/ubuntu1604/virtualbox.sh",
                "scripts/ubuntu1604/parallels.sh",
                "scripts/ubuntu1604/vmware.sh",
                "scripts/ubuntu1604/qemu.sh",
                "scripts/ubuntu1604/cleanup.sh"
            ],
            "type": "shell",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-ubuntu1604-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/ubuntu1610/apt.sh",
                "scripts/ubuntu1610/network.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-ubuntu1610-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/ubuntu1610/limits.sh",
                "scripts/ubuntu1610/postfix.sh",
                "scripts/ubuntu1610/mysql.sh",
                "scripts/ubuntu1610/memcached.sh",
                "scripts/ubuntu1610/floppy.sh",
                "scripts/ubuntu1610/vagrant.sh",
                "scripts/ubuntu1610/motd.sh",
                "scripts/ubuntu1610/magma.sh",
                "scripts/ubuntu1610/fixtty.sh",
                "scripts/ubuntu1610/virtualbox.sh",
                "scripts/ubuntu1610/parallels.sh",
                "scripts/ubuntu1610/vmware.sh",
                "scripts/ubuntu1610/qemu.sh",
                "scripts/ubuntu1610/cleanup.sh"
            ],
            "type": "shell",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-ubuntu1610-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/ubuntu1704/apt.sh",
                "scripts/ubuntu1704/network.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-ubuntu1704-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/ubuntu1704/limits.sh",
                "scripts/ubuntu1704/postfix.sh",
                "scripts/ubuntu1704/mysql.sh",
                "scripts/ubuntu1704/memcached.sh",
                "scripts/ubuntu1704/floppy.sh",
                "scripts/ubuntu1704/vagrant.sh",
                "scripts/ubuntu1704/motd.sh",
                "scripts/ubuntu1704/magma.sh",
                "scripts/ubuntu1704/fixtty.sh",
                "scripts/ubuntu1704/virtualbox.sh",
                "scripts/ubuntu1704/parallels.sh",
                "scripts/ubuntu1704/vmware.sh",
                "scripts/ubuntu1704/qemu.sh",
                "scripts/ubuntu1704/cleanup.sh"
            ],
            "type": "shell",
            "pause_before": "120s",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true",
            "only": [
                "magma-ubuntu1704-virtualbox"
            ]
        },
        {
            "scripts": [
                "scripts/common/motd.sh",
                "scripts/common/keys.sh",
                "scripts/common/machine.sh",
                "scripts/common/leases.sh",
                "scripts/common/localtime.sh",
                "scripts/common/zerodisk.sh",
                "scripts/common/lockout.sh"
            ],
            "type": "shell",
            "start_retry_timeout": "15m",
            "expect_disconnect": "true"
        }
    ],
    "builders": [
        {
            "type": "virtualbox-iso",
            "name": "magma-alpine36-virtualbox",
            "vm_name": "magma-alpine36-virtualbox",
            "output_directory": "output/magma-alpine36-virtualbox",
            "boot_wait": "60s",
            "boot_command": [
                "<enter><wait10>",
                "root<enter><wait>",
                "ifconfig eth0 up && udhcpc -i eth0<enter><wait>",
                "wget http://{{ .HTTPIP }}:{{ .HTTPPort }}/magma.alpine36.vagrant.cfg<enter><wait>",
                "sed -i -e \"/rc-service/d\" /sbin/setup-sshd<enter><wait>",
                "printf \"vagrant\\nvagrant\\ny\\n\" | setup-alpine -f magma.alpine36.vagrant.cfg && ",
                "mount /dev/sda3 /mnt && ",
                "echo 'PasswordAuthentication yes' >> /mnt/etc/ssh/sshd_config && ",
                "echo 'PermitRootLogin yes' >> /mnt/etc/ssh/sshd_config && ",
                "umount /mnt && reboot<enter>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "Linux_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://sjc.edge.kernel.org/alpine/v3.6/releases/x86_64/alpine-virt-3.6.5-x86_64.iso",
            "iso_checksum": "b5936e27487e605ea3cbf040d444505ea7fd735021258d7b119faaa9b4b5b083",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "/sbin/poweroff",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-centos6-virtualbox",
            "vm_name": "magma-centos6-virtualbox",
            "output_directory": "output/magma-centos6-virtualbox",
            "boot_wait": "20s",
            "boot_command": [
                "<tab> text ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/magma.centos6.vagrant.ks<enter><wait>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "RedHat_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://mirrors.edge.kernel.org/centos/6.10/isos/x86_64/CentOS-6.10-x86_64-minimal.iso",
            "iso_checksum": "7c0dee2a0494dabd84809b72ddb4b761f9ef92b78a506aef709b531c54d30770",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-centos7-virtualbox",
            "vm_name": "magma-centos7-virtualbox",
            "output_directory": "output/magma-centos7-virtualbox",
            "boot_wait": "20s",
            "boot_command": [
                "<tab>text ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/magma.centos7.vagrant.ks<enter><wait>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "RedHat_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://mirrors.edge.kernel.org/centos/7.7.1908/isos/x86_64/CentOS-7-x86_64-Minimal-1908.iso",
            "iso_checksum": "9a2c47d97b9975452f7d582264e9fc16d108ed8252ac6816239a3b58cef5c53d",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-arch-virtualbox",
            "vm_name": "magma-arch-virtualbox",
            "output_directory": "output/magma-arch-virtualbox",
            "boot_wait": "30s",
            "boot_command": [
                "<tab><spacebar>",
                "net.ifnames=0 biosdevname=0",
                "<enter><wait10><wait10><wait10><wait10>",
                "curl -O 'http://{{.HTTPIP}}:{{.HTTPPort}}/magma.arch.vagrant{,.chroot}.sh'<enter><wait>",
                "bash magma.arch.vagrant.sh < magma.arch.vagrant.chroot.sh && systemctl reboot<enter>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "ArchLinux_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://mirrors.edge.kernel.org/archlinux/iso/latest/archlinux-2019.11.01-x86_64.iso",
            "iso_checksum": "dcb5853f66fb2513722f84f8f0d14b650ed64d2b7d2fe1b9637d374e4d14cbf7",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "7200s",
            "shutdown_command": "systemctl poweroff",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-fedora27-virtualbox",
            "vm_name": "magma-fedora27-virtualbox",
            "output_directory": "output/magma-fedora27-virtualbox",
            "boot_wait": "20s",
            "boot_command": [
                "<tab> ",
                "inst.ks=http://{{.HTTPIP}}:{{.HTTPPort}}/magma.fedora27.vagrant.ks ",
                "biosdevname=0 ",
                "net.ifnames=0 ",
                "<enter>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "Fedora_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://archives.fedoraproject.org/pub/archive/fedora/linux/releases/27/Server/x86_64/iso/Fedora-Server-netinst-x86_64-27-1.6.iso",
            "iso_checksum": "2b93836c38833b26891345388ff5ddea60529b27a616b4539d432a3520d1c90b",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.1.38/VBoxGuestAdditions_5.1.38.iso",
            "guest_additions_sha256": "0e7ee2c78ebf7cd0d3a933d51148bef04a64f64fb27ccf70d59cddf9ca1e517a",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-debian8-virtualbox",
            "vm_name": "magma-debian8-virtualbox",
            "output_directory": "output/magma-debian8-virtualbox",
            "boot_wait": "20s",
            "boot_command": [
                "<esc><wait>",
                "auto ",
                "ipv6.disable_ipv6=1 net.ifnames=0 biosdevname=0 preseed/url=http://{{.HTTPIP}}:{{.HTTPPort}}/magma.debian8.vagrant.cfg ",
                "<enter>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "Debian_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://gensho.ftp.acc.umu.se/mirror/cdimage/archive/8.11.1/amd64/iso-cd/debian-8.11.1-amd64-netinst.iso",
            "iso_checksum": "ea444d6f8ac95fd51d2aedb8015c57410d1ad19b494cedec6914c17fda02733c",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-ubuntu1604-virtualbox",
            "vm_name": "magma-ubuntu1604-virtualbox",
            "output_directory": "output/magma-ubuntu1604-virtualbox",
            "boot_wait": "20s",
            "boot_command": [
                "<enter><wait>",
                "<f6><esc>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "/install/vmlinuz ",
                "initrd=/install/initrd.gz ",
                "auto-install/enable=true ",
                "debconf/priority=critical ",
                "ipv6.disable_ipv6=1 net.ifnames=0 biosdevname=0 preseed/url=http://{{.HTTPIP}}:{{.HTTPPort}}/magma.ubuntu1604.vagrant.cfg<wait> ",
                "<enter>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "Ubuntu_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://mirrors.kernel.org/ubuntu-releases/16.04.6/ubuntu-16.04.6-server-amd64.iso",
            "iso_checksum": "16afb1375372c57471ea5e29803a89a5a6bd1f6aabea2e5e34ac1ab7eb9786ac",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-ubuntu1610-virtualbox",
            "vm_name": "magma-ubuntu1610-virtualbox",
            "output_directory": "output/magma-ubuntu1610-virtualbox",
            "boot_wait": "20s",
            "boot_command": [
                "<esc><wait>",
                "<esc><wait>",
                "<enter><wait>",
                "/install/vmlinuz ",
                "initrd=/install/initrd.gz ",
                "auto-install/enable=true ",
                "debconf/priority=critical ",
                "ipv6.disable_ipv6=1 net.ifnames=0 biosdevname=0 preseed/url=http://{{.HTTPIP}}:{{.HTTPPort}}/magma.ubuntu1610.vagrant.cfg<wait> ",
                "<enter>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "Ubuntu_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "http://old-releases.ubuntu.com/releases/16.10/ubuntu-16.10-server-amd64.iso",
            "iso_checksum": "72b0d421da77f1e0c549b4efe6fc6c184e9909d6792f0d1e59b56d63e9705659",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-ubuntu1704-virtualbox",
            "vm_name": "magma-ubuntu1704-virtualbox",
            "output_directory": "output/magma-ubuntu1704-virtualbox",
            "boot_wait": "20s",
            "boot_command": [
                "<esc><wait>",
                "<esc><wait>",
                "<enter><wait>",
                "/install/vmlinuz ",
                "initrd=/install/initrd.gz ",
                "auto-install/enable=true ",
                "debconf/priority=critical ",
                "ipv6.disable_ipv6=1 net.ifnames=0 biosdevname=0 preseed/url=http://{{.HTTPIP}}:{{.HTTPPort}}/magma.ubuntu1704.vagrant.cfg<wait> ",
                "<enter>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "Ubuntu_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "http://old-releases.ubuntu.com/releases/17.04/ubuntu-17.04-server-amd64.iso",
            "iso_checksum": "ca5d9a8438e2434b9a3ac2be67b5c5fa2c1f8e3e40b954519462935195464034",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "echo 'vagrant' | sudo -S shutdown -P now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-gentoo-virtualbox",
            "vm_name": "magma-gentoo-virtualbox",
            "output_directory": "output/magma-gentoo-virtualbox",
            "boot_wait": "5s",
            "boot_command": [
                "gentoo-nofb<enter>",
                "<wait10><enter>",
                "<wait10><wait10><wait10><wait10><wait10><wait10><enter>",
                "<wait10><wait10><wait10><wait10><wait10><wait10><enter>",
                "<wait10><wait10><wait10><wait10><wait10><wait10><enter>",
                "passwd root<enter><wait>",
                "vagrant<enter><wait>",
                "vagrant<enter><wait>",
                "curl -O 'http://{{ .HTTPIP }}:{{ .HTTPPort }}/magma.gentoo.vagrant{,.chroot}.sh'<enter><wait>",
                "bash magma.gentoo.vagrant.sh<enter>"
            ],
            "disk_size": 32768,
            "cpus": 4,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "Gentoo_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://mirrors.kernel.org/gentoo/releases/amd64/autobuilds/current-install-amd64-minimal/install-amd64-minimal-20191124T214502Z.iso",
            "iso_checksum": "ba551bd1735c10270805cab8c8d2e89a3bc127dc5f6abb9754c0a9689b79a8ee",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "7200s",
            "shutdown_command": "shutdown -hP now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-freebsd11-virtualbox",
            "vm_name": "magma-freebsd11-virtualbox",
            "output_directory": "output/magma-freebsd11-virtualbox",
            "boot_wait": "1s",
            "boot_command": [
                "<esc><wait><esc><wait><esc><wait><esc><wait>",
                "<esc><wait><esc><wait><esc><wait><esc><wait>",
                "<esc><wait><esc><wait><esc><wait><esc><wait>",
                "<esc><wait><esc><wait><esc><wait><esc><wait>",
                "<esc><wait><esc><wait><esc><wait><esc><wait>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "<bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs><bs>",
                "boot -s<enter>",
                "<wait10><wait10><wait10>",
                "/bin/sh<enter><wait10>",
                "mdmfs -s 100m md1 /tmp<enter><wait5>",
                "mdmfs -s 100m md2 /mnt<enter><wait5>",
                "dhclient -l /tmp/dhclient.lease.em0 em0<enter><wait5>",
                "fetch -o /tmp/installerconfig http://{{ .HTTPIP }}:{{ .HTTPPort }}/magma.freebsd11.vagrant.cfg<enter><wait10>",
                "bsdinstall script /tmp/installerconfig && reboot<enter><wait>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "FreeBSD_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://download.freebsd.org/ftp/releases/ISO-IMAGES/11.3/FreeBSD-11.3-RELEASE-amd64-disc1.iso",
            "iso_checksum": "d268db365e26305ec3d51b29211caad903749c33a4a8f2cf661d671f8e0ba0b0",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "3600s",
            "shutdown_command": "shutdown -p now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        },
        {
            "type": "virtualbox-iso",
            "name": "magma-openbsd6-virtualbox",
            "vm_name": "magma-openbsd6-virtualbox",
            "output_directory": "output/magma-openbsd6-virtualbox",
            "boot_wait": "40s",
            "boot_command": [
                "S<enter><wait>",
                "dhclient em0<enter><wait5>",
                "ftp -o /install.conf http://{{.HTTPIP}}:{{.HTTPPort}}/magma.openbsd6.install.cfg<enter><wait>",
                "ftp -o /install-chroot.sh http://{{.HTTPIP}}:{{.HTTPPort}}/magma.openbsd6.install.chroot.sh<enter><wait>",
                "/install -a -f /install.conf -m install && chroot /mnt < /install-chroot.sh && reboot<enter>"
            ],
            "disk_size": 32768,
            "cpus": 2,
            "memory": 2048,
            "vboxmanage": [
                [
                    "modifyvm",
                    "{{.Name}}",
                    "--vram",
                    "64"
                ]
            ],
            "guest_os_type": "OpenBSD_64",
            "http_directory": "http",
            "headless": true,
            "vrdp_bind_address": "127.0.0.1",
            "vrdp_port_min": 11000,
            "vrdp_port_max": 12000,
            "iso_url": "https://ftp.openbsd.org/pub/OpenBSD/6.6/amd64/cd66.iso",
            "iso_checksum": "c2d4d567657b3160b549ebc08561e3c8a2e8130cdd8d4676476861d5e063ea7a",
            "iso_checksum_type": "sha256",
            "ssh_username": "root",
            "ssh_password": "vagrant",
            "ssh_port": 22,
            "ssh_wait_timeout": "7200s",
            "shutdown_command": "shutdown -h -p now",
            "guest_additions_url": "https://download.virtualbox.org/virtualbox/5.2.34/VBoxGuestAdditions_5.2.34.iso",
            "guest_additions_sha256": "d1b63891abca37fd78f5c8af1764e10e5754b1eecabd1fcfe7599c29a93ba007",
            "guest_additions_path": "VBoxGuestAdditions.iso",
            "guest_additions_mode": "upload",
            "virtualbox_version_file": "VBoxVersion.txt"
        }
    ],
    "post-processors": [
        [
            {
                "type": "vagrant",
                "compression_level": 9,
                "keep_input_artifact": false,
                "vagrantfile_template": "tpl/magma-default.rb",
                "output": "output/{{build_name}}-{{user `box_version`}}.box",
                "include": [
                    "tpl/lavabit/info.json"
                ],
                "except": [
                    "magma-alpine36-virtualbox",
                    "magma-openbsd6-virtualbox",
                    "magma-freebsd11-virtualbox"
                ]
            },
            {
                "type": "checksum",
                "checksum_types": [
                    "sha256"
                ],
                "keep_input_artifact": false,
                "output": "output/{{build_name}}-{{user `box_version`}}.box.sha256",
                "except": [
                    "magma-alpine36-virtualbox",
                    "magma-openbsd6-virtualbox",
                    "magma-freebsd11-virtualbox"
                ]
            }
        ],
        [
            {
                "type": "vagrant",
                "compression_level": 9,
                "keep_input_artifact": false,
                "vagrantfile_template": "tpl/magma-alpine.rb",
                "output": "output/{{build_name}}-{{user `box_version`}}.box",
                "include": [
                    "tpl/lavabit/info.json"
                ],
                "only": [
                    "magma-alpine36-virtualbox"
                ]
            },
            {
                "type": "checksum",
                "checksum_types": [
                    "sha256"
                ],
                "keep_input_artifact": false,
                "output": "output/{{build_name}}-{{user `box_version`}}.box.sha256",
                "only": [
                    "magma-alpine36-virtualbox"
                ]
            }
        ],
        [
            {
                "type": "vagrant",
                "compression_level": 9,
                "keep_input_artifact": false,
                "vagrantfile_template": "tpl/magma-bsd.rb",
                "output": "output/{{build_name}}-{{user `box_version`}}.box",
                "include": [
                    "tpl/lavabit/info.json"
                ],
                "only": [
                    "magma-openbsd6-virtualbox",
                    "magma-freebsd11-virtualbox"
                ]
            },
            {
                "type": "checksum",
                "checksum_types": [
                    "sha256"
                ],
                "keep_input_artifact": false,
                "output": "output/{{build_name}}-{{user `box_version`}}.box.sha256",
                "only": [
                    "magma-openbsd6-virtualbox",
                    "magma-freebsd11-virtualbox"
                ]
            }
        ],
        [
            {
                "type": "vagrant",
                "compression_level": 9,
                "keep_input_artifact": false,
                "vagrantfile_template": "tpl/magma-default.rb",
                "output": "output/{{ replace_all \"-centos6\" \"\" build_name }}-{{user `box_version`}}.box",
                "include": [
                    "tpl/lavabit/info.json"
                ],
                "only": [
                    "magma-centos6-virtualbox"
                ]
            },
            {
                "type": "checksum",
                "checksum_types": [
                    "sha256"
                ],
                "keep_input_artifact": false,
                "output": "output/{{ replace_all \"-centos6\" \"\" build_name }}-{{user `box_version`}}.box.sha256",
                "only": [
                    "magma-centos6-virtualbox"
                ]
            }
        ],
        [
            {
                "type": "vagrant",
                "compression_level": 9,
                "keep_input_artifact": false,
                "vagrantfile_template": "tpl/magma-default.rb",
                "output": "output/{{ replace_all \"centos6\" \"centos\" build_name }}-{{user `box_version`}}.box",
                "include": [
                    "tpl/lavabit/info.json"
                ],
                "only": [
                    "magma-centos6-virtualbox"
                ]
            },
            {
                "type": "checksum",
                "checksum_types": [
                    "sha256"
                ],
                "keep_input_artifact": false,
                "output": "output/{{ replace_all \"centos6\" \"centos\" build_name }}-{{user `box_version`}}.box.sha256",
                "only": [
                    "magma-centos6-virtualbox"
                ]
            }
        ],
        [
          {
                "type": "vagrant",
                "compression_level": 9,
                "keep_input_artifact": false,
                "vagrantfile_template": "tpl/magma-default.rb",
                "output": "output/{{ replace_all \"ubuntu1604\" \"ubuntu\" build_name }}-{{user `box_version`}}.box",
                "include": [
                    "tpl/lavabit/info.json"
                ],
                "only": [
                    "magma-ubuntu1604-virtualbox"
                ]
            },
            {
                "type": "checksum",
                "checksum_types": [
                    "sha256"
                ],
                "keep_input_artifact": false,
                "output": "output/{{ replace_all \"ubuntu1604\" \"ubuntu\" build_name }}-{{user `box_version`}}.box.sha256",
                "only": [
                    "magma-ubuntu1604-virtualbox"
                ]
            }
        ]
    ]
}
